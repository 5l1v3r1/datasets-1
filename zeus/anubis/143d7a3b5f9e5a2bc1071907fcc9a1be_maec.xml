<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE doc [<!ENTITY comma '&#44;'>]>
<maecPackage:MAEC_Package 
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
 xmlns:maecPackage="http://maec.mitre.org/XMLSchema/maec-package-2" 
 xmlns:maecBundle="http://maec.mitre.org/XMLSchema/maec-bundle-4" 
 xmlns:maecVocabs="http://maec.mitre.org/default_vocabularies-1" 
 xmlns:mmdef="http://xml/metadataSharing.xsd" 
 xmlns:cybox="http://cybox.mitre.org/cybox-2" 
 xmlns:cyboxCommon="http://cybox.mitre.org/common-2" 
 xmlns:cyboxVocabs="http://cybox.mitre.org/default_vocabularies-2" 
 xmlns:WinExecutableFileObj="http://cybox.mitre.org/objects#WinExecutableFileObject-2" 
 xmlns:ProcessObj="http://cybox.mitre.org/objects#ProcessObject-2" 
 xmlns:WinRegistryKeyObj="http://cybox.mitre.org/objects#WinRegistryKeyObject-2" 
 xmlns:FileObj="http://cybox.mitre.org/objects#FileObject-2" 
 xmlns:PipeObj="http://cybox.mitre.org/objects#PipeObject-2" 
 xmlns:WinFileObj="http://cybox.mitre.org/objects#WinFileObject-2" 
 xmlns:WinComputerAccountObj="http://cybox.mitre.org/objects#WinComputerAccountObject-2" 
 xmlns:AccountObj="http://cybox.mitre.org/objects#AccountObject-2" 
 xmlns:PortObj="http://cybox.mitre.org/objects#PortObject-2" 
 xmlns:NetworkConnectionObj="http://cybox.mitre.org/objects#NetworkConnectionObject-2" 
 xmlns:SocketAddressObj="http://cybox.mitre.org/objects#SocketAddressObject-1" 
 xmlns:AddressObj="http://cybox.mitre.org/objects#AddressObject-2" 
 xmlns:HTTPSessionObj="http://cybox.mitre.org/objects#HTTPSessionObject-2" 
 xmlns:URIObj="http://cybox.mitre.org/objects#URIObject-2" 
 xmlns:DNSQueryObj="http://cybox.mitre.org/objects#DNSQueryObject-2" 
 xmlns:DNSRecordObj="http://cybox.mitre.org/objects#DNSRecordObject-2" 
 xmlns:WinHandleObj="http://cybox.mitre.org/objects#WinHandleObject-2" 
 xsi:schemaLocation="http://maec.mitre.org/default_vocabularies-1 http://maec.mitre.org/language/version4.0.1/maec_default_vocabularies.xsd
 http://maec.mitre.org/XMLSchema/maec-package-2 http://maec.mitre.org/language/version4.0.1/maec_package_schema.xsd
 http://cybox.mitre.org/cybox-2 http://cybox.mitre.org/XMLSchema/core/2.0.1/cybox_core.xsd
 http://maec.mitre.org/default_vocabularies-1 http://cybox.mitre.org/XMLSchema/default_vocabularies/2.0.1/cybox_default_vocabularies.xsd
 http://cybox.mitre.org/objects#WinExecutableFileObject-2 http://cybox.mitre.org/XMLSchema/objects/Win_Executable_File/2.0.1/Win_Executable_File_Object.xsd
 http://cybox.mitre.org/objects#ProcessObject-2 http://cybox.mitre.org/XMLSchema/objects/Process/2.0.1/Process_Object.xsd
 http://cybox.mitre.org/objects#WinRegistryKeyObject-2 http://cybox.mitre.org/XMLSchema/objects/Win_Registry_Key/2.0.1/Win_Registry_Key_Object.xsd
 http://cybox.mitre.org/objects#FileObject-2 http://cybox.mitre.org/XMLSchema/objects/File/2.0.1/File_Object.xsd
 http://cybox.mitre.org/objects#PipeObject-2 http://cybox.mitre.org/XMLSchema/objects/Pipe/2.0.1/Pipe_Object.xsd" id="maec-anubis_to_maec-pkg-1" schema_version="2.0.1">
    <maecPackage:Malware_Subjects>
        <maecPackage:Malware_Subject id="maec-anubis_to_maec-sub-1">
            <maecPackage:Malware_Instance_Object_Attributes id="maec-anubis_to_maec-obj-1">
                <cybox:Properties xsi:type="WinExecutableFileObj:WindowsExecutableFileObjectType">
                    <FileObj:Size_In_Bytes>46592</FileObj:Size_In_Bytes>
                    <FileObj:Hashes>
                        <cyboxCommon:Hash>
                            <cyboxCommon:Type>MD5</cyboxCommon:Type>
                            <cyboxCommon:Simple_Hash_Value>143d7a3b5f9e5a2bc1071907fcc9a1be</cyboxCommon:Simple_Hash_Value>
                        </cyboxCommon:Hash>
                        <cyboxCommon:Hash>
                            <cyboxCommon:Type>SHA1</cyboxCommon:Type>
                            <cyboxCommon:Simple_Hash_Value>6553ab304ea71c51cb222db0372e58da5e19b958</cyboxCommon:Simple_Hash_Value>
                        </cyboxCommon:Hash>
                    </FileObj:Hashes>
                </cybox:Properties>
            </maecPackage:Malware_Instance_Object_Attributes>
            <maecPackage:Analyses>
                <maecPackage:Analysis method="dynamic" type="triage" id="maec-anubis_to_maec-ana-1">
                    <maecPackage:Findings_Bundle_Reference bundle_idref="maec-anubis_to_maec-bnd-1"/>
                    <maecPackage:Tools>
                        <maecPackage:Tool id="maec-anubis_to_maec-tol-1">
                            <cyboxCommon:Name>TTAnalyze</cyboxCommon:Name>
                            <cyboxCommon:Vendor>ISECLab</cyboxCommon:Vendor>
                        </maecPackage:Tool>
                    </maecPackage:Tools>
                    <maecPackage:Dynamic_Analysis_Metadata>
                        <maecPackage:Command_Line>C:\sample.exe</maecPackage:Command_Line>
                        <maecPackage:Exit_Code>0</maecPackage:Exit_Code>
                    </maecPackage:Dynamic_Analysis_Metadata>
                </maecPackage:Analysis>
            </maecPackage:Analyses>
            <maecPackage:Findings_Bundles>
                <maecPackage:Bundle defined_subject="false" id="maec-anubis_to_maec-bnd-1" schema_version="4.0.1">
                    <maecBundle:Process_Tree>
                        <maecBundle:Root_Process xsi:type="maecBundle:ProcessTreeNodeType" id="maec-anubis_to_maec-pro-1">
                            <ProcessObj:Name>sample.exe</ProcessObj:Name>
                            <ProcessObj:Image_Info>
                                <ProcessObj:Path>C:\sample.exe</ProcessObj:Path>
                            </ProcessObj:Image_Info>
                            <maecBundle:Initiated_Actions>
                                <maecBundle:Action_Reference action_id="maec-anubis_to_maec-act-1"/>
                                <maecBundle:Action_Reference action_id="maec-anubis_to_maec-act-2"/>
                                <maecBundle:Action_Reference action_id="maec-anubis_to_maec-act-3"/>
                                <maecBundle:Action_Reference action_id="maec-anubis_to_maec-act-4"/>
                                <maecBundle:Action_Reference action_id="maec-anubis_to_maec-act-5"/>
                                <maecBundle:Action_Reference action_id="maec-anubis_to_maec-act-6"/>
                            </maecBundle:Initiated_Actions>
                        </maecBundle:Root_Process>
                    </maecBundle:Process_Tree>
                    <maecBundle:Collections>
                        <maecBundle:Action_Collections>
                            <maecBundle:Action_Collection name="registry" id="maec-anubis_to_maec-actc-1">
                                <maecBundle:Action_List>
                                    <maecBundle:Action id="maec-anubis_to_maec-act-4">
                                        <cybox:Name xsi:type="maecVocabs:RegistryActionNameVocab-1.0">modify registry key value</cybox:Name>
                                        <cybox:Associated_Objects>
                                            <cybox:Associated_Object id="maec-anubis_to_maec-obj-6">
                                                <cybox:Properties xsi:type="WinRegistryKeyObj:WindowsRegistryKeyObjectType">
                                                    <WinRegistryKeyObj:Key>software\microsoft\windows nt\currentversion\winlogon</WinRegistryKeyObj:Key>
                                                    <WinRegistryKeyObj:Hive>HKEY_LOCAL_MACHINE</WinRegistryKeyObj:Hive>
                                                    <WinRegistryKeyObj:Values>
                                                        <WinRegistryKeyObj:Value>
                                                            <WinRegistryKeyObj:Name>userinit</WinRegistryKeyObj:Name>
                                                            <WinRegistryKeyObj:Data>C:\WINDOWS\system32\userinit.exe,C:\WINDOWS\system32\ntos.exe,</WinRegistryKeyObj:Data>
                                                        </WinRegistryKeyObj:Value>
                                                    </WinRegistryKeyObj:Values>
                                                </cybox:Properties>
                                                <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
                                            </cybox:Associated_Object>
                                        </cybox:Associated_Objects>
                                    </maecBundle:Action>
                                    <maecBundle:Action id="maec-anubis_to_maec-act-5">
                                        <cybox:Name xsi:type="maecVocabs:RegistryActionNameVocab-1.0">read registry key value</cybox:Name>
                                        <cybox:Associated_Objects>
                                            <cybox:Associated_Object id="maec-anubis_to_maec-obj-7">
                                                <cybox:Properties xsi:type="WinRegistryKeyObj:WindowsRegistryKeyObjectType">
                                                    <WinRegistryKeyObj:Key>System\CurrentControlSet\Control\ComputerName\ActiveComputerName</WinRegistryKeyObj:Key>
                                                    <WinRegistryKeyObj:Hive>HKEY_LOCAL_MACHINE</WinRegistryKeyObj:Hive>
                                                    <WinRegistryKeyObj:Values>
                                                        <WinRegistryKeyObj:Value>
                                                            <WinRegistryKeyObj:Name>ComputerName</WinRegistryKeyObj:Name>
                                                            <WinRegistryKeyObj:Data>USER</WinRegistryKeyObj:Data>
                                                        </WinRegistryKeyObj:Value>
                                                    </WinRegistryKeyObj:Values>
                                                </cybox:Properties>
                                                <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
                                            </cybox:Associated_Object>
                                        </cybox:Associated_Objects>
                                    </maecBundle:Action>
                                    <maecBundle:Action id="maec-anubis_to_maec-act-6">
                                        <cybox:Name xsi:type="maecVocabs:RegistryActionNameVocab-1.0">read registry key value</cybox:Name>
                                        <cybox:Associated_Objects>
                                            <cybox:Associated_Object id="maec-anubis_to_maec-obj-8">
                                                <cybox:Properties xsi:type="WinRegistryKeyObj:WindowsRegistryKeyObjectType">
                                                    <WinRegistryKeyObj:Key>software\microsoft\windows nt\currentversion\winlogon</WinRegistryKeyObj:Key>
                                                    <WinRegistryKeyObj:Hive>HKEY_LOCAL_MACHINE</WinRegistryKeyObj:Hive>
                                                    <WinRegistryKeyObj:Values>
                                                        <WinRegistryKeyObj:Value>
                                                            <WinRegistryKeyObj:Name>userinit</WinRegistryKeyObj:Name>
                                                            <WinRegistryKeyObj:Data>C:\WINDOWS\system32\userinit.exe,</WinRegistryKeyObj:Data>
                                                        </WinRegistryKeyObj:Value>
                                                    </WinRegistryKeyObj:Values>
                                                </cybox:Properties>
                                                <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
                                            </cybox:Associated_Object>
                                        </cybox:Associated_Objects>
                                    </maecBundle:Action>
                                </maecBundle:Action_List>
                            </maecBundle:Action_Collection>
                            <maecBundle:Action_Collection name="file_system" id="maec-anubis_to_maec-actc-2">
                                <maecBundle:Action_List>
                                    <maecBundle:Action id="maec-anubis_to_maec-act-1">
                                        <cybox:Name xsi:type="maecVocabs:FileActionNameVocab-1.0">create file</cybox:Name>
                                        <cybox:Associated_Objects>
                                            <cybox:Associated_Object id="maec-anubis_to_maec-obj-3">
                                                <cybox:Properties xsi:type="FileObj:FileObjectType">
                                                    <FileObj:File_Name>ntos.exe</FileObj:File_Name>
                                                    <FileObj:Full_Path>C:\WINDOWS\system32\ntos.exe</FileObj:Full_Path>
                                                </cybox:Properties>
                                                <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
                                            </cybox:Associated_Object>
                                        </cybox:Associated_Objects>
                                    </maecBundle:Action>
                                    <maecBundle:Action id="maec-anubis_to_maec-act-2">
                                        <cybox:Name xsi:type="maecVocabs:IPCActionNameVocab-1.0">read from named pipe</cybox:Name>
                                        <cybox:Associated_Objects>
                                            <cybox:Associated_Object id="maec-anubis_to_maec-obj-4">
                                                <cybox:Properties xsi:type="PipeObj:PipeObjectType" named="true">
                                                    <PipeObj:Name>lsarpc</PipeObj:Name>
                                                </cybox:Properties>
                                                <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">input</cybox:Association_Type>
                                            </cybox:Associated_Object>
                                        </cybox:Associated_Objects>
                                    </maecBundle:Action>
                                    <maecBundle:Action id="maec-anubis_to_maec-act-3">
                                        <cybox:Name xsi:type="maecVocabs:IPCActionNameVocab-1.0">write to named pipe</cybox:Name>
                                        <cybox:Associated_Objects>
                                            <cybox:Associated_Object id="maec-anubis_to_maec-obj-5">
                                                <cybox:Properties xsi:type="PipeObj:PipeObjectType" named="true">
                                                    <PipeObj:Name>lsarpc</PipeObj:Name>
                                                </cybox:Properties>
                                                <cybox:Association_Type xsi:type="maecVocabs:ActionObjectAssociationTypeVocab-1.0">output</cybox:Association_Type>
                                            </cybox:Associated_Object>
                                        </cybox:Associated_Objects>
                                    </maecBundle:Action>
                                </maecBundle:Action_List>
                            </maecBundle:Action_Collection>
                        </maecBundle:Action_Collections>
                    </maecBundle:Collections>
                </maecPackage:Bundle>
            </maecPackage:Findings_Bundles>
        </maecPackage:Malware_Subject>
    </maecPackage:Malware_Subjects>
</maecPackage:MAEC_Package>
